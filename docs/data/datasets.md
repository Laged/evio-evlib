# Dataset Manifest

This document catalogs all datasets in `evio/data/junction-sensofusion.zip`.

**CRITICAL DISTINCTION:** The ZIP contains TWO completely independent dataset collections:

1. **Legacy Sensofusion .dat files** - Original recordings for parity testing
2. **IDS Camera .raw files (EVT3)** - NEW separate recordings from Nov 2025

⚠️ **THESE ARE NOT THE SAME RECORDINGS!** Do NOT use .raw files for legacy parity testing.

See `docs/plans/raw-to-evt3-deprecation.md` for diagnostic evidence proving they are different captures.

---

## Legacy Sensofusion .dat Files

**Source:** Original Sensofusion event camera recordings
**Format:** Custom binary with minimal header (`% Height`, `% Version 2`, `% end`)
**Resolution:** 1280×720 (hardcoded in loader)
**Loader:** `evio.core.recording.open_dat(path, width=1280, height=720)`
**evlib Compatibility:** Requires export to HDF5 (use `convert-legacy-dat-to-hdf5`)

| File | Events | Duration | Polarity | Size |
|------|--------|----------|----------|------|
| `fan/fan_const_rpm.dat` | 26.4M | 9.5 sec | 13.4M ON / 13.0M OFF | 202 MB |
| `fan/fan_varying_rpm.dat` | 64.1M | 22.3 sec | 32.5M ON / 31.6M OFF | 489 MB |
| `fan/fan_varying_rpm_turning.dat` | 48.1M | 24.3 sec | 24.5M ON / 23.6M OFF | 367 MB |
| `drone_idle/drone_idle.dat` | 92.0M | 10.1 sec | 88.2M ON / 3.8M OFF | 736 MB |
| `drone_moving/drone_moving.dat` | ? | ? | ? | 1487 MB |

---

## IDS Camera .raw Files (EVT3 Format)

**Source:** NEW IDS Imaging Development Systems captures (Nov 2025)
**Format:** Standard Prophesee EVT3 with full ASCII header
**Resolution:** Header claims 1280×720, actual events span ~2040×1793
**Loader:** `evlib.load_events(path)` (native support)
**evlib Compatibility:** Native (no conversion needed)

**⚠️ WARNING:** These are **NOT** the same recordings as legacy .dat files!

| File | Events | Duration | Polarity | Size | Notes |
|------|--------|----------|----------|------|-------|
| `fan/fan_const_rpm.raw` | 30.4M | 682 sec | 217K ON / 0 OFF | 119 MB | Broken polarity |
| `fan/fan_varying_rpm.raw` | 73.4M | 699 sec | 516K ON / 0 OFF | 288 MB | Broken polarity |
| `fan/fan_varying_rpm_turning.raw` | 60.2M | 717 sec | 592K ON / 0 OFF | 225 MB | Broken polarity |
| `drone_idle/drone_idle.raw` | ? | ? | ? | 1029 MB | - |
| `drone_moving/drone_moving.raw` | ? | ? | ? | 789 MB | - |

**Polarity Issue:** All IDS .raw files report 0 OFF events, suggesting encoding bug in IDS export or evlib decoder.

---

## Converted Files (Generated Locally)

### Legacy Export to HDF5
Generated by `convert-legacy-dat-to-hdf5`:

| File | Source | Events | Format |
|------|--------|--------|--------|
| `fan/fan_const_rpm_legacy.h5` | `fan_const_rpm.dat` | 26.4M | HDF5 (evlib schema) |
| `fan/fan_varying_rpm_legacy.h5` | `fan_varying_rpm.dat` | 64.1M | HDF5 (evlib schema) |
| `fan/fan_varying_rpm_turning_legacy.h5` | `fan_varying_rpm_turning.dat` | 48.1M | HDF5 (evlib schema) |

---

## Usage Guidelines

### For Legacy Parity Testing
✅ Use `*_legacy.h5` files (exported from legacy .dat)
❌ Do NOT use `_evt3.dat` files (different recordings)

### For evlib Experimentation
✅ Use `.raw` or `_evt3.dat` files (native EVT3 support)
⚠️ Be aware of polarity encoding issue

### For Demos
- `run-demo-fan`: Legacy loader on `fan_const_rpm.dat`
- `run-demo-fan-ev3`: evlib on `fan_const_rpm_legacy.h5` (SAME recording)

---

## Conversion Commands

### Generate Legacy HDF5 Files

```bash
# Convert all legacy .dat files to HDF5 (recommended)
nix develop --command convert-all-legacy-to-hdf5

# Or convert single file
nix develop --command convert-legacy-dat-to-hdf5 evio/data/fan/fan_const_rpm.dat
```

This creates `<stem>_legacy.h5` files that evlib can load natively.

---

## Diagnostic Scripts

Run these to verify dataset properties:

```bash
# Single file diagnosis
nix develop --command uv run --package evio python scripts/diagnose_fan_data.py

# Compare all fan files
nix develop --command uv run --package evio python scripts/compare_all_fan_files.py
```

---

## APPENDIX: Experimental IDS Data Conversion (Not for Legacy Parity)

### IDS .raw → .dat (Header Preservation)
Generated by `convert-all-datasets` (DEPRECATED - use for IDS experimentation only):

| File | Source | Events | Format |
|------|--------|--------|--------|
| `fan/fan_const_rpm_evt3.dat` | `fan_const_rpm.raw` | 30.4M | EVT3 .dat container |
| `fan/fan_varying_rpm_evt3.dat` | `fan_varying_rpm.raw` | 73.4M | EVT3 .dat container |
| `fan/fan_varying_rpm_turning_evt3.dat` | `fan_varying_rpm_turning.raw` | 60.2M | EVT3 .dat container |

**⚠️ WARNING:** These files are NOT suitable replacements for legacy .dat files.
They are different recordings from different hardware with:
- Different resolutions (2040×1793 vs 1280×720)
- Different durations (682s vs 9.5s)
- Different event counts (30M vs 26M)
- Broken polarity encoding (0 OFF events)

Use ONLY for evlib performance testing or IDS-specific experiments.
For legacy parity, use `*_legacy.h5` files exported via `convert-legacy-dat-to-hdf5`.
